<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Token Generator</title>
</head>
<body>
  <h2>Generator DRM ID + Signature (base64url)</h2>
  <label>ID (misal: var10): <input id="id" value="var10" /></label><br><br>
  <label>Secret Key: <input id="secret" value="lumayan" /></label><br><br>
  <button onclick="generate()">Generate</button>

  <h3>Hasil:</h3>
  <div id="output" style="font-family: monospace;"></div>

  <script>
    async function generate() {
      const id = document.getElementById('id').value.trim();
      const secret = document.getElementById('secret').value.trim();

      const encoder = new TextEncoder();
      const keyData = encoder.encode(secret);
      const idData = encoder.encode(id);

      const cryptoKey = await crypto.subtle.importKey(
        'raw', keyData, { name: 'HMAC', hash: 'SHA-256' }, false, ['sign']
      );

      const signature = await crypto.subtle.sign('HMAC', cryptoKey, idData);
      const sigB64url = btoa(String.fromCharCode(...new Uint8Array(signature)))
        .replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');

      document.getElementById('output').innerText =
        `id=${id}&sig=${sigB64url}`;
    }
  </script>
</body>
</html>
